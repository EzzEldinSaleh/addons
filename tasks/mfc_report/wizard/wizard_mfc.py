import ioimport base64from odoo import api, fields, models,_try:    from odoo.tools.misc import xlsxwriterexcept ImportError:    import xlsxwriterclass wizardmfc(models.TransientModel):    _name = 'wizard.mfc'    mfc_ids = fields.Many2many(comodel_name="mrp.production", string="Bills Of Materials", )    excel_sheet = fields.Binary('Download Report')    excel_sheet_name = fields.Char(string='Name', size=64)    def export_to_excel(self):        # data = {        #     'model': 'wizard.mfc',        #     'form': self.read()[0]        # }        #        # return self.env.ref('mfc_report.mfc_report_xlsx').with_context(landscape=True).report_action(self, data=data)        row=2        col=1        report_name = 'report'        output = io.BytesIO()        workbook = xlsxwriter.Workbook(output, {'in_memory': True})        sheet = workbook.add_worksheet(report_name[:31])        bold = workbook.add_format({'bold': True, 'align': 'center', 'border': 2})        for obj in self.mfc_ids:            row += 5            # boldd = workbook.add_format({'bold': True, 'align': 'center','border':2,'bg_color':'yellow',})            sheet.merge_range(f"B{row+1}:G{row+1}", 'Bill of Material :%s'%obj.name, bold)            row=row+2            sheet.merge_range(row, col,row,2, "Components",)            # col+=2            sheet.write(row, col+2, "On Hand",)            sheet.merge_range(f"E{row+1}:F{row+1}","To Consume",)            # col+=3            sheet.write(row, col+5, "FP",)            # col+=1            sheet.write(row, col+6, "Surplus",)            # list = []            for line in obj.move_raw_ids:                row=row+1                sheet.merge_range(row, col,row,2,line.product_id.name,)                # col+=2                sheet.write(row,col+2, line.product_id.qty_available,)                tocon=line.product_uom_qty / obj.product_qty                # list.append(line.product_id.qty_available/tocon)                sheet.merge_range(f"E{row+1}:F{row+1}",tocon,)                # col+=3                minoffp=[]                for x in obj.move_raw_ids:                    minoffp.append(x.product_id.qty_available/tocon)                sheet.write(row, col+5,int(line.product_id.qty_available/tocon),)                sheet.write(row, col+6,int(line.product_id.qty_available/tocon)-min(minoffp))            row+=1            sheet.merge_range(f"B{row+1}:F{row+1}", "Qty can be manufactured" )            sheet.write(row,col+5, min(minoffp))        self.excel_sheet_name = 'Report Mfc'        workbook.close()        output.seek(0)        self.excel_sheet = base64.encodestring(output.read())        self.excel_sheet_name = str(self.excel_sheet_name) + '.xlsx'        return {            'type': 'ir.actions.act_url',            'name': '41 Report',            'url': '/web/content/wizard.mfc/%s/excel_sheet/Report Mfc.xlsx?download=true' % (self.id),            'target': 'self'        }